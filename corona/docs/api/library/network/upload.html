<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Corona Docs: API > Libraries > network > upload</title>
  <meta name="revised" content="16-May-2013" />
  <meta name="description" content="Whether you're new to Corona or want to take your app to the next level, we've got a wealth of resources for you including extensive documentation, API reference, sample code, and videos.  API > Libraries > network > upload" />
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />
<script src="//www.coronalabs.com/wp-content/themes/corona-labs/js/docs.js"></script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='http://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../index.html">SDK APIs</a></li>
<li><a href="../../../native/index.html">Enterprise APIs</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="http://www.coronalabs.com/resources/tutorials/">Tutorials</a></li>
</ul>


		<div id="resources-link"><a href="http://www.coronalabs.com/resources/">Corona Resources</a> &#9657;</div>
	</div>
</div>

<div class="SearchBar">
  <form action="http://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" id="q" autocomplete="off" size="40" style="width:150px;float:left" />
  <input type="submit" name="sa" value="Search" style="float:right; font-size: 13px;" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#network.upload">network.upload()</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#gotchas"> Gotchas</a><ul>
<li><a href="#android">Android</a></li>
</ul></li>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#url-required">url <sub><sup>(required)</sup></sub></a></li>
<li><a href="#method-required">method <sub><sup>(required)</sup></sub></a></li>
<li><a href="#listener-required">listener <sub><sup>(required)</sup></sub></a></li>
<li><a href="#params-optional">params <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#filename-required">filename <sub><sup>(required)</sup></sub></a></li>
<li><a href="#basedirectory-optional">baseDirectory <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#contenttype-optional">contentType <sub><sup>(optional)</sup></sub></a></li>
</ul></li>
<li><a href="#examples">Examples</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="http://docs.coronalabs.com">Ξ</a>  ▸  <a href="../../index.html">API</a>  ▸  <a href="../index.html">Libraries</a>  ▸  <a href="index.html">network</a>  ▸  <a href="upload.html">upload</a>
</div>
<div class="section level1" id="network.upload">
<h1><a href="#TOC">network.upload()</a></h1>
<blockquote>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>Type</strong></td>
<td align="left"><a href="../../type/Function.html">Function</a></td>
</tr>
<tr class="even">
<td align="left"><strong>Library</strong></td>
<td align="left"><a href="index.html">network.*</a></td>
</tr>
<tr class="odd">
<td align="left"><strong>Return value</strong></td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left"><strong>Revision</strong></td>
<td align="left"><a href="http://coronalabs.com/links/docs/current-corona-sdk">Current Public Release (2013.2076)</a></td>
</tr>
<tr class="odd">
<td align="left"><strong>Keywords</strong></td>
<td align="left">asynchronous, http, https, get, post, upload</td>
</tr>
<tr class="even">
<td align="left"><strong>See also</strong></td>
<td align="left"><a href="request.html">network.request()</a></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><a href="cancel.html">network.cancel()</a></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><a href="download.html">network.download()</a></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><a href="../../event/networkRequest/index.html">networkRequest</a></td>
</tr>
</tbody>
</table>
</blockquote>
<div class="section level2" id="overview">
<h2><a href="#TOC">Overview</a></h2>
<p>This API is a convenience method that is very similar to the asynchronous <a href="request.html">network.request()</a>, except that always attempts to upload the request from a local file that you specify. In fact, this method simply calls <a href="request.html">network.request()</a>, putting the source filename and baseDirectory parameters into a params.body table, adding contentType as a params.headers request header value, and specifying <code>&quot;upload&quot;</code> progress notifications.</p>
<p>This function returns a handle that can be passed to <a href="cancel.html">network.cancel()</a> in order to cancel the request.</p>
</div>
<div class="section level2" id="gotchas">
<h2><a href="#TOC"> Gotchas</a></h2>
<p>You cannot execute a network upload during a <a href="../../event/system/type.html">System Suspend/Exit event</a>. After Corona suspends, no callbacks will fire.</p>
<p>You can work around this by saving the upload request you wish to make from a file upon a <a href="../../event/system/type.html">System Suspend/Exit event</a>. Then on a <a href="../../event/system/type.html">System Resume event</a>, check if there is a pending request saved, and if there is, upload it.</p>
<div class="section level4" id="android">
<h4><a href="#TOC">Android</a></h4>
<p>On Android, you must add the following permission to the &quot;build.settings&quot; file.</p>
<pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">settings</span> <span class="ot">=</span>
<span class="ot">{</span>
   <span class="kw">android</span> <span class="ot">=</span>
   <span class="ot">{</span>
      <span class="kw">usesPermissions</span> <span class="ot">=</span>
      <span class="ot">{</span>
         <span class="st">&quot;android.permission.INTERNET&quot;</span>,
      <span class="ot">}</span>,
   <span class="ot">}</span>,
<span class="ot">}</span></code></pre>
</div>
</div>
<div class="section level2" id="syntax">
<h2><a href="#TOC">Syntax</a></h2>
<pre><code>network.upload( url, method, listener [, params], filename [, baseDirectory] [, contentType] )</code></pre>
<div class="section level5" id="url-required">
<h5><a href="#TOC">url <sub><sup>(required)</sup></sub></a></h5>
<p><em><a href="../../type/String.html">String</a>.</em> The HTTP request URL.</p>
</div>
<div class="section level5" id="method-required">
<h5><a href="#TOC">method <sub><sup>(required)</sup></sub></a></h5>
<p><em><a href="../../type/String.html">String</a>.</em> The HTTP method; should typically be either <code>&quot;PUT&quot;</code> or <code>&quot;POST&quot;</code> for a file upload.</p>
</div>
<div class="section level5" id="listener-required">
<h5><a href="#TOC">listener <sub><sup>(required)</sup></sub></a></h5>
<p><em><a href="../../type/Listener.html">Listener</a>.</em> The listener function invoked at various phases of the HTTP operation. It is passed a <a href="../../event/networkRequest/index.html">networkRequest</a> event. This API provides <code>&quot;upload&quot;</code> progress when progress = true, meaning that the listener will receive events for <code>&quot;began&quot;</code>, <code>&quot;progress&quot;</code>, and <code>&quot;ended&quot;</code> phases. If the progress parameter is not enabled, the listener will only be invoked with an '&quot;ended&quot;' phase.</p>
</div>
<div class="section level5" id="params-optional">
<h5><a href="#TOC">params <sub><sup>(optional)</sup></sub></a></h5>
<p><em><a href="../../type/Table.html">Table</a>.</em> A table that specifies HTTP request processing options, including custom request headers.</p>
<ul>
<li><code>params.headers</code> A table specifying header values with string keys.</li>
<li><code>params.timeout</code> A time out in seconds. Default is 30 seconds. (Available on Mac/iOS)</li>
<li><code>params.bodyType</code> A string indicating whether a string request body is <code>&quot;text&quot;</code> or <code>&quot;binary&quot;</code>, default is <code>&quot;text&quot;</code>.</li>
<li><code>params.progress</code> Setting to true enables the progress events. Default is nil, indicating that only the <code>&quot;ended&quot;</code> phase event is desired.</li>
</ul>
</div>
<div class="section level5" id="filename-required">
<h5><a href="#TOC">filename <sub><sup>(required)</sup></sub></a></h5>
<p><em><a href="../../type/String.html">String</a>.</em> The name of the file to upload.</p>
</div>
<div class="section level5" id="basedirectory-optional">
<h5><a href="#TOC">baseDirectory <sub><sup>(optional)</sup></sub></a></h5>
<p><em><a href="../../type/Constant.html">Constant</a>.</em> The directory of the file to upload. Defaults to <a href="../system/DocumentsDirectory.html">system.DocumentsDirectory</a> if not provided.</p>
</div>
<div class="section level5" id="contenttype-optional">
<h5><a href="#TOC">contentType <sub><sup>(optional)</sup></sub></a></h5>
<p><em><a href="../../type/Constant.html">Constant</a>.</em> The Content-Type of the file being uploaded. While this value is optional, a Content-Type <em>must</em> be provided, either via this parameter, or via a params.header value.</p>
</div>
</div>
<div class="section level2" id="examples">
<h2><a href="#TOC">Examples</a></h2>
<p>The following code demonstrates an HTTP post, where the request body comes from a file.</p>
<p>Note: This example demonstrates one possible way to upload a file. Different web servers and applications support different methods of file upload. For example, some REST services support upload of a binary file in the body of a PUT request. Many web servers only allow file uploads using multipart/form-encoded (text) request bodies in a POST request. If you are going to attempt file upload, you must first understand the specific mechanism supported by the specific web server or application that you will be working with, and then you must form your request data and choose your request method appropriately.</p>
<pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> <span class="kw">function</span> networkListener<span class="ot">(</span> <span class="kw">event</span> <span class="ot">)</span>
        <span class="kw">if</span> <span class="ot">(</span> <span class="kw">event</span><span class="ot">.</span><span class="kw">isError</span> <span class="ot">)</span> <span class="kw">then</span>
                <span class="fu">print</span><span class="ot">(</span> <span class="st">&quot;Network error!&quot;</span><span class="ot">)</span>
        <span class="kw">elseif</span> <span class="ot">(</span> <span class="kw">event</span><span class="ot">.</span><span class="kw">phase</span> <span class="ot">==</span> <span class="st">&quot;ended&quot;</span> <span class="ot">)</span> <span class="kw">then</span>
                <span class="fu">print</span> <span class="ot">(</span> <span class="st">&quot;Upload complete!&quot;</span> <span class="ot">)</span>
        <span class="kw">end</span>
<span class="kw">end</span>

<span class="kw">network</span><span class="ot">.</span>upload<span class="ot">(</span> 
        <span class="st">&quot;http://127.0.0.1/restapi.php&quot;</span>, 
        <span class="st">&quot;POST&quot;</span>, 
        <span class="kw">networkListener</span>, 
        <span class="st">&quot;object.json&quot;</span>, 
        <span class="kw">system</span><span class="ot">.</span><span class="kw">DocumentsDirectory</span>, 
        <span class="st">&quot;application/json&quot;</span> 
        <span class="ot">)</span></code></pre>
<div id="footer">
<p style="font-size: 13px">
© 2013 Corona Labs Inc. All Rights Reserved. (Last updated: 16-May-2013)
</p>

<br />
<p>
<strong>Help us help you! Give us feedback on this page:</strong>
</p>

<ul>
<li>
<a href="https://coronalabs.wufoo.com/forms/z7p9w5/def/field3=api.library.network.upload&field4=Current+Public+Release+%282013%2E2076%29" target="_blank">Love it</a>
</li>

<li>
<a href="https://coronalabs.wufoo.com/forms/z7p9m3/def/field103=api.library.network.upload&field104=Current+Public+Release+%282013%2E2076%29" target="_blank">Like it, but...</a>
</li>

<li>
<a href="https://coronalabs.wufoo.com/forms/z7p8x1/def/field103=api.library.network.upload&field104=Current+Public+Release+%282013%2E2076%29" target="_blank">Hate it</a>
</li>
</ul>
</div>

































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































</div>
</div>

</body>
</html>